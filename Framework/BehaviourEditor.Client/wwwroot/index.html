<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>BehaviourEditor</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/site.css" rel="stylesheet" />
</head>
<body>
    <app>Loading...</app>

    <script src="_framework/blazor.webassembly.js"></script>

    <script>
        document.onmousedown = mouseDownHandler;

        function mouseDownHandler(event) {
            console.log(event.target.classList);
            if (!event.target.classList.contains("jsDraggable")) {
                return;
			}
			
			let moveGraphic = event.target;
			let shiftX = event.clientX - moveGraphic.getBoundingClientRect().left;
			let shiftY = event.clientY - moveGraphic.getBoundingClientRect().top;
            
            moveAt(event.pageX, event.pageY);

			function moveAt(pageX, pageY) {
				var destX = pageX - shiftX - moveGraphic.parentNode.getBoundingClientRect().x;
				var destY = pageY - shiftY - moveGraphic.parentNode.getBoundingClientRect().y;
                //var destX = pageX - shiftX;
                //var destY = pageY - shiftY;

                moveGraphic.style.left = destX + 'px';
                moveGraphic.style.top = destY + 'px';
            }

            function onMouseMove(event) {
                moveAt(event.pageX, event.pageY);
                console.log("Position " + event.pageX + ", " + event.pageY);
            }

            document.addEventListener('mousemove', onMouseMove);

            moveGraphic.onmouseup = function () {
                console.log("Mouse Up");
                document.removeEventListener('mousemove', onMouseMove);
                moveGraphic.onmouseup = null;
            };
        }

        document.ondragstart = dragStartHandler;

        function dragStartHandler(event) {
            if (!this.classList.contains("jsDraggable")) {
                return;
            }
            return false;
        }
    </script>
</body>
</html>
